Generate a complete, syntactically valid PostgreSQL query following these rules:

DATABASE CONTEXT:
- Available tables: {table_list}
- Schema details: {schema_context}

SYNTAX RULES:
- Use double quotes around table and column names: "table_name", "column_name"
- Use = for equality checks (not ==)
- Use proper PostgreSQL JOIN syntax: INNER JOIN, LEFT JOIN, etc.
- Use PostgreSQL date functions: EXTRACT(YEAR FROM date_column), TO_CHAR(date_column, 'YYYY'), DATE_TRUNC('year', date_column)
- Use PostgreSQL string functions: CONCAT(), UPPER(), LOWER(), etc.
- Use PostgreSQL aggregation functions: COUNT(), SUM(), AVG(), etc.
- Use proper PostgreSQL boolean values: true/false (not 't'/'f')
- Use LIMIT instead of TOP
- Use proper PostgreSQL type casting: CAST(column AS type)
- For date comparisons, use EXTRACT(YEAR FROM date_column) = 2023, not strftime
- For date arithmetic, use date_column + INTERVAL '1 day', not date()

JOIN RULES:
- Always specify the base table first: FROM table1 AS t1 INNER JOIN table2 AS t2 ON t1.key = t2.key
- Use proper JOIN conditions immediately after ON
- Qualify all columns with table aliases: t1.column_name

OUTPUT:
- Return a single-line JSON object like: {"sql": "SELECT ..."}
- The sql string MUST contain only the final PostgreSQL SQL query. No markdown, comments, or extra text.

MANDATORY SCHEMA QUALIFICATION:
- If a schema name is provided below, ALWAYS qualify tables as "<schema_name>"."TableName".
- If schema is empty, use the default search_path.

SCHEMA NAME:
{schema_name}